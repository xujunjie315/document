# 云胶片院内接口文档V2.0.1

## 1. 修改历史

日期|修改人|备注
-|-|-
2018-10-30|尹绍彬|首次创建

## 2. 概述

该文档描述医院与一脉云对接云胶片产品时需要提供的数据接口，接口提供方式建议采用数据库视图方式。

> 该文档目前只使用于有登记系统，一脉云可以直接在检查登记后立即获取到登记信息的医院。对于无登记流程的医院暂不适用。

## 3. 接口列表

### 3.1. 获取检查登记信息 RegList (院内PACS/RIS提供)

#### 3.1.1 描述

该接口用于获取检查登记信息，当病人登记后可立即获取到登记信息数据，每次登记信息修改或取消数据必须相应变化，并且更新 LatestUpdateDt 字段，登记数据必须一直存在不能随检查流程变化而消失。一脉云获取数据时使用增量获取的方式，因此请务必提供 LatestUpdateDt 字段，作为增量获取依据

#### 3.1.2 字段列表

字段名称|类型|描述|备注
-|-|-|-|
ExamId|字符串|检查Id|检查唯一标识
DcmRefId|字符串|影像关联Id|DICOM Study唯一关联标识
ExamSchCode|字符串|检查检索编号|病人取片依据，有条码时条码号优先
RegDt|字符串|登记时间|yyyy-MM-dd HH:mm:ss
ApptExamDt|字符串|预约检查时间|yyyy-MM-dd HH:mm:ss
PatHisId|字符串|病人HIS Id|病人HIS唯一标识
PatName|字符串|病人姓名
PatCertCode|字符串|病人证件号
PatCertType|枚举值|病人证件类型|SF, HZ, JG
PatSex|枚举值|病人性别|M, F, O
PatBirthDate|字符串|病人出生日期|yyyy-MM-dd
PatAge|字符串|病人年龄|检查时年龄(年月日)，比如 12y, 3m, 2d
PatCellphone|字符串|病人手机号
ClinicalDiagnosis|字符串|临床诊断
MedicalHistory|字符串|病史
ApplyDept|字符串|申请科室
Modality|枚举值|检查模态|CR, DX, CT, MR, US, MG, DS, PT
ExamRoom|字符串|影像室|检查所在影像室
ExamRoomDesc|字符串|影像室位置描述
ExamItems|字符串|检查项目列表|格式：编号:::名称，多项目以 ___ 分隔
TotalFee|数字|费用|单位：分
RegStatus|枚举值|登记状态|SUCCEED, CANCELLED
LatestUpdateDt|字符串|最近修改时间|yyyy-MM-dd HH:mm:ss,最后新建或修改数据的时间

#### 3.1.3 特别说明

1. 检查检索编号是只病人用户获取报告的依据，可以是检查号，影像号等，甚至可以是病人姓名

2. 考虑到检查项目字段包含键值列表数据，在数据组织时有一定难度，因此提供一种变通获取检查项目列表的方式：可在本视图接口的基础上再提供一个检查项目列表的接口，字段列表如下：

    RegExamItemList

    字段名称|类型|描述|备注
    -|-|-|-|
    ExamId|字符串|检查Id|检查唯一标识
    ItemCode|字符串|检查项目编号
    ItemName|字符串|检查项目名称

#### 3.1.4 枚举值说明

1. 病人性别 PatSex

    枚举值|说明
    -|-
    M|男
    F|女
    O|其他

2. 检查模态 Modality

    依据DICOM标准，[参考链接](http://dicom.nema.org/medical/dicom/current/output/chtml/part03/sect_C.7.3.html#sect_C.7.3.1.1.1)

3. 登记状态 RegStatus

    枚举值|说明
    -|-
    SUCCEED|登记成功
    CANCELLED|登记已取消

4. 病人证件类型 PatCertType

    枚举值|说明
    -|-
    SF|身份证
    HZ|护照
    JG|军官证

### 3.2 获取已发布的报告信息 RptList (院内PACS/RIS提供)

#### 3.2.1 描述

该接口用于获取已经正式发布的报告列表，当报告发布后可立即获取到报告信息数据，每次报告修改重新发布时数据必须相应变化，并且更新 LatestUpdateDt 字段。一脉云获取数据时使用增量获取的方式，因此请务必提供 LatestUpdateDt 字段，作为增量获取依据

#### 3.2.2 字段列表

字段名称|类型|描述|备注
-|-|-|-|
RptId|字符串|报告Id|报告唯一标识
ExamId|字符串|检查Id|检查唯一标识，必须与登记中ExamId对应
ExamDt|字符串|检查执行时间|yyyy-MM-dd HH:mm:ss
ReporterCode|字符串|报告医生编号
ReporterName|字符串|报告医生姓名
ReportDt|字符串|报告时间|yyyy-MM-dd HH:mm:ss
ApproverCode|字符串|终审医生编号
ApproverName|字符串|终审医生姓名
ApproverDt|字符串|终审时间|yyyy-MM-dd HH:mm:ss
TechnicianCode|字符串|技师编号
TechnicianName|字符串|技师姓名
RptTitle|字符串|报告标题
Wys|字符串|影像学表现
Wyg|字符串|影像学诊断
Pon|枚举值|报告阴阳性|POS, NEG, UKW
Critical|枚举值|报告危急值|NOR, CRI
ExamItems|字符串|检查项目列表|格式：编号:::名称，多项目以 ___ 分隔
LatestUpdateDt|字符串|最近修改时间|yyyy-MM-dd HH:mm:ss,最后新建或修改数据的时间

#### 3.2.3 特别说明

1. 报告唯一标识用于在一次检查存在多份报告时使用。

2. 当报告与检查一一对应时，检查项目字段可以省略，反之则必须提供

3. 考虑到检查项目字段包含键值列表数据，在数据组织时有一定难度，因此提供一种变通获取检查项目列表的方式：可在本视图接口的基础上再提供一个检查项目列表的接口，字段列表如下：

    RptExamItemList

    字段名称|类型|描述|备注
    -|-|-|-|
    ExamId|字符串|检查Id|检查唯一标识
    ItemCode|字符串|检查项目编号
    ItemName|字符串|检查项目名称

#### 3.2.4 枚举值说明

1. 报告阴阳性 Pon

    枚举值|说明
    -|-
    POS|阳性
    NEG|阴性
    UKW|未知

2. 报告危急值 Critical

    枚举值|说明
    -|-
    NOR|常规
    CRI|危急
